
# Local anchor definitions for external component examples. There isn't a native OpenAPI way to
# cross-reference examples across files, so we define them here for reuse.
_imported_examples:
  uuid-example: &uuid-example "3fa85f64-5717-4562-b3fc-2c963f66afa6"
  wifi-wpa2-personal-basic-example: &wifi-wpa2-personal-basic-example
    accessType: "Wi-Fi:WPA_PERSONAL"
    securityMode:
      password: "my-password"
      securityModeType: "WPA2-Personal"

  wifi-wpa2-personal-example: &wifi-wpa2-personal-example
    accessType: "Wi-Fi:WPA_PERSONAL"
    ssid: "my-ssid"
    securityMode:
      password: "my-password"
      securityModeType: "WPA2-Personal"

  wifi-wpa3-personal-example: &wifi-wpa3-personal-example
    accessType: "Wi-Fi:WPA_PERSONAL"
    ssid: "my-ssid"
    securityMode:
      password: "my-password"
      securityModeType: "WPA3-Personal"

  thread-structured-example: &thread-structured-example
    accessType: "Thread:STRUCTURED"
    mode: "structured"
    channel: 13
    extendedPanId: "d63e8e3e495ebbc3"
    networkKey: "dfd34f0f05cad978ec4e32b0413038ff"
    networkName: "Spec-Thread-B3AF"
    panId: "d63e"

  thread-tlv-example: &thread-tlv-example
    accessType: "Thread:TLV"
    mode: tlv
    operationalDataset: "0e08000000000000010010000102030405060708090a0b0c0d0e0f"

  max-devices-policy-example: &max-devices-policy-example
    maxDevices: 10

  max-bandwidth-policy-example: &max-bandwidth-policy-example
    maxDomainDownstreamRate:
      value: 1000000
      unit: Kbps
    maxDomainUpstreamRate:
      value: 500000
      unit: Kbps

  egress-allowed-list-policy-example: &egress-allowed-list-policy-example
    egressAllowedList:
      - "api.vendor.com"
      - "updates.vendor.com"


components:

  securitySchemes:
    openId:
      type: openIdConnect
      description:  |
        OpenID Connect authentication with scope-based authorization.

        **Resource Isolation:**
        All scopes only grant access to Trust Domains created by the same API client.
        API clients cannot access Trust Domains created by other API clients.

        **Scope Inheritance:**
        - `create` inherits `read`, `write`, and `delete`
        - `delete` inherits `read` and `write`
        - `write` inherits `read`
        - `read` is the base permission level

        **Available Scopes:**
        - `network-access-management:trust-domains:read` - List and view Trust Domains created by this API client
        - `network-access-management:trust-domains:write` - Modify existing Trust Domains created by this API client (inherits read)
        - `network-access-management:trust-domains:delete` - Delete existing Trust Domains created by this API client (inherits read, write)
        - `network-access-management:trust-domains:create` - Create new Trust Domains (inherits read, write, delete)
      openIdConnectUrl: https://example.com/.well-known/openid-configuration

  parameters:
    trustDomainId:
      name: trustDomainId
      in: path
      required: true
      schema:
        $ref: "../Common.yaml#/components/schemas/UUID"
      description: ID of the Trust Domain

  schemas:

    TrustDomainUpdate:
      type: object
      description: Represents the updatable fields of a trust domain within the network access management system.
      properties:
        name:
          type: string
          description: Human-readable name for the trust domain.
          example: "Primary WiFi Network"
        description:
          type: string
          description: Detailed description of the trust domain.
          example: "Primary home WiFi Network for all devices"
        enabled:
          type: boolean
          description: Indicates whether the trust domain is currently enabled.
          example: true
        expiration:
          $ref: "../Common.yaml#/components/schemas/DateTime"
          description: |
            The expiration date and time of the network.  It must follow [RFC 3339](https://datatracker.ietf.org/doc/html/rfc3339#section-5.6)
            and must have time zone. Recommended format is yyyy-MM-dd'T'HH:mm:ss.SSSZ (i.e. which allows
            2023-07-03T14:27:08.312+02:00 or 2023-07-03T12:27:08.312Z).

            If omitted, the trust domain will not automatically expire.
        policies:
          $ref: "../Policy.yaml#/components/schemas/Policies"
        accessDetails:
          type: array
          description: A list of access details for the trust domain. Defines how devices gain admittance to the network via this trust domain.
          items:
            $ref: "../AccessDetail.yaml#/components/schemas/AccessDetail"
          minItems: 1

    TrustDomainCreate:
      allOf:
        - $ref: "#/components/schemas/TrustDomainUpdate"
      description: Represents the creation of a new trust domain within the network access management system.
      required:
        - name
        - enabled
        - accessDetails

    TrustDomain:
      allOf:
        - $ref: "#/components/schemas/TrustDomainUpdate"
        - type: object
          properties:
            id:
              $ref: "../Common.yaml#/components/schemas/UUID"
            createdAt:
              allOf:
                - $ref: "../Common.yaml#/components/schemas/DateTime"
                - description: |
                    The creation date and time of the trust domain.  It must follow [RFC 3339](https://datatracker.ietf.org/doc/html/rfc3339#section-5.6)
                    and must have time zone. Recommended format is yyyy-MM-dd'T'HH:mm:ss.SSSZ (i.e. which allows
                    2023-07-03T14:27:08.312+02:00 or 2023-07-03T12:27:08.312Z).
            createdBy:
              type: string
              maxLength: 100
              description: The user who created the network
              example: "user-1"
            modifiedAt:
              allOf:
                - $ref: "../Common.yaml#/components/schemas/DateTime"
                - description: |
                    The last update date and time of the trust domain.  It must follow [RFC 3339](https://datatracker.ietf.org/doc/html/rfc3339#section-5.6)
                    and must have time zone. Recommended format is yyyy-MM-dd'T'HH:mm:ss.SSSZ (i.e. which allows
                    2023-07-03T14:27:08.312+02:00 or 2023-07-03T12:27:08.312Z).
            modifiedBy:
              type: string
              maxLength: 100
              description: The user who last updated the trust domain
              example: "user-2"
          required:
            - id
      description: Represents a trust domain within the network access management system.


  examples:

    TrustDomainCreateWpa2Personal:
      summary: Create a Trust Domain with WPA2-Personal Wi-Fi access.
      value:
        name: "Primary WiFi Network"
        description: "Request defines a Trust Domain with WPA2-Personal Wi-Fi access. The request specifies an SSID, implying the SSID is created on the network infrastructure."
        enabled: true
        accessDetails:
          - <<: *wifi-wpa2-personal-example

    TrustDomainCreateInferredSsid:
      summary: Create a Trust Domain with inferred SSID Wi-Fi access.
      value:
        name: "Inferred SSID Network"
        description: "Request defines a Trust Domain with inferred SSID Wi-Fi access. The request omits the SSID, implying the Trust Domain is applied to an existing SSID on the network infrastructure."
        enabled: true
        accessDetails:
          - accessType: "Wi-Fi:WPA_PERSONAL"
            securityMode:
              password: "my-password"
              securityModeType: "WPA2-Personal"

    TrustDomainCreateEphemeral:
      summary: Create a Trust Domain with ephemeral access details.
      value:
        name: "Ephemeral Network"
        description: "Request defines a Trust Domain with ephemeral access details."
        enabled: true
        accessDetails:
          - <<: *wifi-wpa3-personal-example
        expiration: "2024-12-31T23:59:59Z"
        policies:
          <<: *max-devices-policy-example

    TrustDomainCreateThreadStructured:
      summary: Create a Trust Domain with Thread structured access details.
      value:
        name: "Thread Structured Network"
        description: "Request defines a Trust Domain with Thread structured access details."
        enabled: true
        accessDetails:
          - <<: *thread-structured-example

    TrustDomainCreateQoSPolicies:
      summary: Create a Trust Domain with QoS policies.
      value:
        name: "QoS Policy Network"
        description: "Request defines a Trust Domain with QoS policies."
        enabled: true
        accessDetails:
          - <<: *wifi-wpa3-personal-example
        policies:
          <<: *max-bandwidth-policy-example

    TrustDomainResponseBasic:
      summary: Basic Trust Domain Response
      description: Example of a created Trust Domain with minimal details.
      value:
        id: *uuid-example
        name: "Basic Trust Domain"
        description: "A basic trust domain example"
        enabled: true
        accessDetails:
          - <<: *wifi-wpa2-personal-basic-example
        createdAt: "2025-10-21T14:27:08.312Z"
        createdBy: "user-1"
        modifiedAt: "2025-10-21T14:27:08.312Z"
        modifiedBy: "user-1"

    TrustDomainResponseWiFiThread:
      summary: Created Trust Domain (Wi-Fi + Thread)
      description: Example of a created Trust Domain including Wi-Fi and Thread access details and populated policies.
      value:
        id: *uuid-example
        name: "Primary WiFi Network"
        description: "Primary home Wi-Fi Network for all devices"
        enabled: true
        expiration: "2025-10-21T14:27:08.312Z"
        policies:
          <<: *egress-allowed-list-policy-example
        accessDetails:
          - <<: *wifi-wpa3-personal-example
          - <<: *thread-structured-example
        createdAt: "2025-10-21T14:27:08.312Z"
        createdBy: "user-1"
        modifiedAt: "2025-10-21T14:27:08.312Z"
        modifiedBy: "user-2"
